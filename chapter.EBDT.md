<div xmlns="http://www.w3.org/1999/xhtml" role="" class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="chapter.EBDT"></a>Chapter 27. EBDT - Embedded Bitmap Data Table</h2></div></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320126972928"></a>Overview</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.1.1"></a>Specification</h3></div></div></div><p role="">Three tables are used to embed bitmaps in
          OpenType fonts. They are the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a>
          table for embedded bitmap locators, the
          <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a> table for embedded bitmap data, and
          the <a role="" class="link" href="chapter.EBSC.md" title="Chapter 29. EBSC - Embedded Bitmap Scaling Table">EBSC</a> table for embedded bitmap
          scaling information.</p><p role="">OpenType embedded bitmaps are also called 'sbits' (for
          "scaler bitmaps"). A set of bitmaps for a face at a given
          size is called a strike.</p><p role="">The <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> table identifies the sizes
          and glyph ranges of the sbits, and keeps offsets to glyph
          bitmap data in indexSubTables. The <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a>
          table then stores the glyph bitmap data, in a number of
          different possible formats.  Glyph metrics information may
          be stored in either the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> or
          <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a> table, depending upon the
          indexSubTable and glyph bitmap data formats. The
          <a role="" class="link" href="chapter.EBSC.md" title="Chapter 29. EBSC - Embedded Bitmap Scaling Table">EBSC</a> table identifies sizes that will be
          handled by scaling up or scaling down other sbit
          sizes.</p><p role="">The <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a> table is a superset of
          Apple's AAT (Apple Advanced Typography) 'bdat' table.</p><p role="">The <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a> table begins with a header
          containing simply the table version number.</p><div class="table"><a name="idm320126961648"></a><p class="title"><strong>Table 27.1. ?</strong></p><div class="table-contents"><table role="" class="table" summary="?" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">FIXED</td><td role="">version</td><td role="">Initially defined as 0x00020000</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">The rest of the <a role="" class="link" href="chapter.EBDT.md" title="Chapter 27. EBDT - Embedded Bitmap Data Table">EBDT</a> table is a
          collection of bitmap data. The data can be in a number of
          possible formats, indicated by information in the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a>
          table. Some of the formats contain metric information plus
          image data, and other formats contain only the image
          data. Long word alignment is not required for these sub
          tables; byte alignment is sufficient.</p><p role="">There are also two different formats for glyph metrics:
          big glyph metrics and small glyph metrics. Big glyph metrics
          define metrics information for both horizontal and vertical
          layouts. This is important in fonts (such as Kanji) where
          both types of layout may be used. Small glyph metrics define
          metrics information for one layout direction only. Which
          direction applies, horizontal or vertical, is determined by
          the 'flags' field in the bitmapSizeTable field of the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a>
          table.</p><div class="table"><a name="idm320126954112"></a><p class="title"><strong>Table 27.2. bigGlyphMetrics</strong></p><div class="table-contents"><table role="" class="table" summary="bigGlyphMetrics" border="1"><colgroup><col width="3cm"/><col width="3cm"/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th></tr></thead><tbody><tr><td role="">BYTE</td><td role="">height</td></tr><tr><td role="">BYTE</td><td role="">width</td></tr><tr><td role="">CHAR</td><td role="">horiBearingX</td></tr><tr><td role="">CHAR</td><td role="">horiBearingY</td></tr><tr><td role="">BYTE</td><td role="">horiAdvance</td></tr><tr><td role="">CHAR</td><td role="">vertBearingX</td></tr><tr><td role="">CHAR</td><td role="">vertBearingY</td></tr><tr><td role="">BYTE</td><td role="">vertAdvance</td></tr></tbody></table></div></div><br class="table-break"/><div class="table"><a name="idm320129434032"></a><p class="title"><strong>Table 27.3. smallGlyphMetrics</strong></p><div class="table-contents"><table role="" class="table" summary="smallGlyphMetrics" border="1"><colgroup><col width="3cm"/><col width="3cm"/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th></tr></thead><tbody><tr><td role="">BYTE</td><td role="">height</td></tr><tr><td role="">BYTE</td><td role="">width</td></tr><tr><td role="">CHAR</td><td role="">BearingX</td></tr><tr><td role="">CHAR</td><td role="">BearingY</td></tr><tr><td role="">BYTE</td><td role="">Advance</td></tr></tbody></table></div></div><br class="table-break"/><p role="">The nine different formats currently defined for glyph
          bitmap data are listed and described below. Different
          formats are better for different purposes. Apple 'bdat'
          tables support only formats 1 through 7.</p><p role="">In all formats, if the bitDepth is greater than 1, all
          of a pixel's bits are stored consecutively in memory, and
          all of a row's pixels are stored consecutively.</p><p role="">Note: Each of these formats can contain black/white or
          grayscale bitmaps depending on the setting of the bitDepth
          field in the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> table. For performance reasons, we
          recommend using a byte-aligned format for embedded bitmaps
          with bitDepth of 8.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129420704"></a>Format 1: small metrics, byte-aligned data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.2.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129418864"></a><p class="title"><strong>Table 27.4. </strong></p><div class="table-contents"><table role="" class="table" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">smallGlyphMetrics</td><td role="">smallMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">VARIABLE</td><td role="">image data</td><td role="">Byte-aligned bitmap data</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap format 1 consists of small metrics records
          (either horizontal or vertical depending on the
          bitmapSizeTable 'flag' value in the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> table) followed
          by byte aligned bitmap data. The bitmap data begins with the
          most significant bit of the first byte corresponding to the
          top-left pixel of the bounding box, proceeding through
          succeeding bits moving left to right. The data for each row
          is padded to a byte boundary, so the next row begins with
          the most significant bit of a new byte. 1 bits correspond to
          black, and 0 bits to white.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129411600"></a>Format 2: small metrics, bit-aligned data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.3.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129409760"></a><p class="title"><strong>Table 27.5. ?</strong></p><div class="table-contents"><table role="" class="table" summary="?" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">smallGlyphMetrics</td><td role="">smallMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">VARIABLE</td><td role="">image data</td><td role="">Bit-aligned bitmap data</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap format 2 is the same as format 1 except
          that the bitmap data is bit aligned. This means that the
          data for a new row will begin with the bit immediately
          following the last bit of the previous row. The start of
          each glyph must be byte aligned, so the last row of a glyph
          may require padding. This format takes a little more time to
          parse, but saves file space compared to format 1. </p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129403072"></a>Format 3: (obsolete)</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.4.1"></a>Specification</h3></div></div></div><p role="">Format 3 is obsolete.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129400272"></a>Format 4: (not supported) metrics in EBLC, compressed
        data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.5.1"></a>Specification</h3></div></div></div><p role="">Glyph bitmap format 4 is a compressed format used by
          Apple in some of their Far East fonts. MS has not
          implemented it in our rasterizer.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129397296"></a>Format 5: metrics in EBLC, bit-aligned image data
        only</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.6.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129395440"></a><p class="title"><strong>Table 27.6. ?</strong></p><div class="table-contents"><table role="" class="table" summary="?" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">VARIABLE</td><td role="">image data</td><td role="">Bit-aligned bitmap data</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap format 5 is similar to format 2 except that
          no metrics information is included, just the bit aligned
          data. This format is for use with <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> indexSubTable
          format 2 or format 5, which will contain the metrics
          information for all glyphs. It works well for Kanji
          fonts.</p><p role="">The rasterizer recalculates sbit metrics for Format 5
          bitmap data, allowing Windows to report correct ABC widths,
          even if the bitmaps have white space on either side of the
          bitmap image. This allows fonts to store monospaced bitmap
          glyphs in the efficient Format 5 without breaking Windows
          GetABCWidths call.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129388992"></a>Format 6: big metrics, byte-aligned data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.7.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129387152"></a><p class="title"><strong>Table 27.7. ?</strong></p><div class="table-contents"><table role="" class="table" summary="?" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">bigGlyphMetrics</td><td role="">bigMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">VARIABLE</td><td role="">image data</td><td role="">Byte-aligned bitmap data</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap format 6 is the same as format 1 except
          that is uses big glyph metrics instead of small.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129380832"></a>Format 7: big metrics, bit-aligned data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.8.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129378992"></a><p class="title"><strong>Table 27.8. </strong></p><div class="table-contents"><table role="" class="table" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">bigGlyphMetrics</td><td role="">bigMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">VARIABLE</td><td role="">image data</td><td role="">Bit-aligned bitmap data</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap format 7 is the same as format 2 except
          that is uses big glyph metrics instead of small.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129372928"></a>ebdtComponent; array used by Formats 8 and 9</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.9.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129371088"></a><p class="title"><strong>Table 27.9. </strong></p><div class="table-contents"><table role="" class="table" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">USHORT</td><td role="">glyphCode</td><td role="">Component glyph code</td><td class="auto-generated"> </td></tr><tr><td role="">CHAR</td><td role="">xOffset</td><td role="">Position of component left</td><td class="auto-generated"> </td></tr><tr><td role="">CHAR</td><td role="">yOffset</td><td role="">Position of component top</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">The component array, used by Formats 8 and 9, contains
          the glyph code of the component, which can be looked up in
          the <a role="" class="link" href="chapter.EBLC.md" title="Chapter 28. EBLC - Embedded Bitmap Location Table">EBLC</a> table, as well as xOffset and yOffset values
          which tell where to position the top-left corner of the
          component in the composite. Nested composites (a composite
          of composites) are allowed, and the number of nesting levels
          is determined by implementation stack space.</p></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129362576"></a>Format 8: small metrics, component data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.10.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129360736"></a><p class="title"><strong>Table 27.10. </strong></p><div class="table-contents"><table role="" class="table" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">smallGlyphMetrics</td><td role="">smallMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">BYTE</td><td role="">pad</td><td role="">Pad to short boundary</td><td class="auto-generated"> </td></tr><tr><td role="">USHORT</td><td role="">numComponents</td><td role="">Number of components</td><td class="auto-generated"> </td></tr><tr><td role="">ebdtComponent</td><td role="">componentArray [n]</td><td role="">Glyph code, offset array</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/></div></div><div role="fragment" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm320129352208"></a>Format 9: big metrics, component data</h2></div></div></div><div role="specification" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="section.27.11.1"></a>Specification</h3></div></div></div><div class="table"><a name="idm320129350368"></a><p class="title"><strong>Table 27.11. </strong></p><div class="table-contents"><table role="" class="table" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th role="">Type</th><th role="">Name</th><th role="">Description</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td role="">bigGlyphMetrics</td><td role="">bigMetrics</td><td role="">Metrics information for the
              glyph</td><td class="auto-generated"> </td></tr><tr><td role="">USHORT</td><td role="">numComponents</td><td role="">Number of components</td><td class="auto-generated"> </td></tr><tr><td role="">ebdtComponent</td><td role="">componentArray [n]</td><td role="">Glyph code, offset array</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break"/><p role="">Glyph bitmap formats 8 and 9 are used for composite
          bitmaps. For accented characters and other composite glyphs
          it may be more efficient to store a copy of each component
          separately, and then use a composite description to
          construct the finished glyph. The composite formats allow
          for any number of components, and allow the components to be
          positioned anywhere in the finished glyph. Format 8 uses
          small metrics, and format 9 uses big metrics.</p></div></div></div>