<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<section role="compiler">
      <title>Compiler</title>
      <code-fragment id="lookuptable.methods">
  private Block contextLookupFormat3FromXML (Element subtable, Element table,
                                            Map&lt;Element, Block&gt; blockCache,
					    Map&lt;String, Integer&gt; lookupIndices)
      throws InvalidFontException, UnsupportedFontException {

    Block me;

    NodeList coverages = subtable.getElementsByTagName ("coverage");
    int glyphCount = coverages.getLength ();

    NodeList applies = subtable.getElementsByTagName ("apply");
    int substCount = applies.getLength ();

    me = new Block (6 + 2*glyphCount + 4*substCount, glyphCount);
    me.setuint16 (0, 3);
    me.setuint16 (2, glyphCount);
    me.setuint16 (4, substCount);

    for (int i = 0; i &lt; glyphCount; i++) {
      Element coverage = (Element) coverages.item (i);
      me.setOffset (6 + 2*i, coverageFromXML (coverage, table, blockCache)); }

    subLookupsFromXML (substCount, applies, me, 6 + 2*glyphCount, lookupIndices);

    return me;
  }
</code-fragment>
    </section>
    
