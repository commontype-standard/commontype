<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<section role="implementation">
      <title>Implementation</title>
      <code-fragment package="com.adobe.aots.CommonType" class="OS2"><code-title>OS2 class</code-title>
package com.adobe.aots.CommonType;

import org.w3c.dom.Element;
import org.w3c.dom.NodeList;
import org.xml.sax.helpers.AttributesImpl;

import com.adobe.aots.util.ContentHandlerPlus;

public class OS2 extends Table {

  public OS2 () {
    super (Tag.os2, null);
  }

  public OS2 (Font font) {
    super (Tag.os2, font);
  }

  public int getTypoAscender () {
    return getint16 (68);
  }

  public int getTypoDescender () {
    return getint16 (70);
  }

  public int getTypoLineGap () {
    return getint16 (72);
  }

  public int getXHeight () {
    return getint16 (86);
  }

  public int getCapHeight () {
    return getint16 (88);
  }

  <code-include linkend="os2.methods"/>
}
</code-fragment>
      <para>Here are strings for the names of the various bitfields.</para>
      <code-fragment id="os2.methods"><code-title/>

  public static final int[] fsType_version2format = {0, 0, 1, 1, 1, 1};
  public static final String[][] fsTypeNames =
    {{null,                 null},
     {"Restricted",         "Restricted"},
     {"Preview_and_print",  "Preview_and_print"},
     {"Editable_embedding", "Editable_embedding"},
     {null,                 null},
     {null,                 null},
     {null,                 null},
     {null,                 null},
     {null,                 "No_subsetting"},
     {null,                 "Bitmap_embedding_only"},
     {null,                 null},
     {null,                 null},
     {null,                 null},
     {null,                 null},
     {null,                 null},
     {null,                 null}};


  public static final String[/*bit*/][/*version*/] unicodeRangeNames = {
    {null,                                        /* bit 0 */
     "Basic_Latin",
     "Basic_Latin",
     "Basic_Latin",
     "Basic_Latin",
     "Basic_Latin"},
    {null,                                        /* bit 1 */
     "Latin_1_Supplement",
     "Latin_1_Supplement",
     "Latin_1_Supplement",
     "Latin_1_Supplement",
     "Latin_1_Supplement"},
    {null,                                        /* bit 2 */
     "Latin_Extended_A",
     "Latin_Extended_A",
     "Latin_Extended_A",
     "Latin_Extended_A",
     "Latin_Extended_A"},
    {null,                                        /* bit 3 */
     "Latin_Extended_B",
     "Latin_Extended_B",
     "Latin_Extended_B",
     "Latin_Extended_B",
     "Latin_Extended_B"},
    {null,                                        /* bit 4 */
     "IPA_Extensions",
     "IPA_Extensions",
     "IPA_Extensions",
     "IPA_Extensions",
     "IPA_Extensions"},
    {null,                                        /* bit 5 */
     "Spacing_Modifier_Letters",
     "Spacing_Modifier_Letters",
     "Spacing_Modifier_Letters",
     "Spacing_Modifier_Letters",
     "Spacing_Modifier_Letters"},
    {null,                                        /* bit 6 */
     "Combining_Diacritical_Marks",
     "Combining_Diacritical_Marks",
     "Combining_Diacritical_Marks",
     "Combining_Diacritical_Marks",
     "Combining_Diacritical_Marks"},
    {null,                                        /* bit 7 */
     "Greek",
     "Greek",
     "Greek",
     "Greek",
     "Greek"},
    {null,                                        /* bit 8 */
     "Greek_Symbols_And_Coptic",
     null,
     null,
     "Coptic",
     "Coptic"},
    {null,                                        /* bit 9 */
     "Cyrillic",
     "Cyrillic",
     "Cyrillic",
     "Cyrillic",
     "Cyrillic"},
    {null,                                        /* bit 10 */
     "Armenian",
     "Armenian",
     "Armenian",
     "Armenian",
     "Armenian"},
    {null,                                        /* bit 11 */
     "Hebrew",
     "Hebrew",
     "Hebrew",
     "Hebrew",
     "Hebrew"},
    {null,                                        /* bit 12 */
     "Hebrew_Extended",
     null,
     null,
     "Vai",
     "Vai"},
    {null,                                        /* bit 13 */
     "Arabic",
     "Arabic",
     "Arabic",
     "Arabic",
     "Arabic"},
    {null,                                        /* bit 14 */
     "Arabic_Extended",
     null,
     null,
     "NKo",
     "NKo"},
    {null,                                        /* bit 15 */
     "Devanagari",
     "Devanagari",
     "Devanagari",
     "Devanagari",
     "Devanagari"},
    {null,                                        /* bit 16 */
     "Bengali",
     "Bengali",
     "Bengali",
     "Bengali",
     "Bengali"},
    {null,                                        /* bit 17 */
     "Gurmukhi",
     "Gurmukhi",
     "Gurmukhi",
     "Gurmukhi",
     "Gurmukhi"},
    {null,                                        /* bit 18 */
     "Gujarati",
     "Gujarati",
     "Gujarati",
     "Gujarati",
     "Gujarati"},
    {null,                                        /* bit 19 */
     "Oriya",
     "Oriya",
     "Oriya",
     "Oriya",
     "Oriya"},
    {null,                                        /* bit 20 */
     "Tamil",
     "Tamil",
     "Tamil",
     "Tamil",
     "Tamil"},
    {null,                                        /* bit 21 */
     "Telugu",
     "Telugu",
     "Telugu",
     "Telugu",
     "Telugu"},
    {null,                                        /* bit 22 */
     "Kannada",
     "Kannada",
     "Kannada",
     "Kannada",
     "Kannada"},
    {null,                                        /* bit 23 */
     "Malayalam",
     "Malayalam",
     "Malayalam",
     "Malayalam",
     "Malayalam"},
    {null,                                        /* bit 24 */
     "Thai",
     "Thai",
     "Thai",
     "Thai",
     "Thai"},
    {null,                                        /* bit 25 */
     "Lao",
     "Lao",
     "Lao",
     "Lao",
     "Lao"},
    {null,                                        /* bit 26 */
     "Georgian",
     "Georgian",
     "Georgian",
     "Georgian",
     "Georgian"},
    {null,                                        /* bit 27 */
     "Georgian_Extended",
     null,
     null,
     "Balinese",
     "Balinese"},
    {null,                                        /* bit 28 */
     "Hangul_Jamo",
     "Hangul_Jamo",
     "Hangul_Jamo",
     "Hangul_Jamo",
     "Hangul_Jamo"},
    {null,                                        /* bit 29 */
     "Latin_Extended_Additional",
     "Latin_Extended_Additional",
     "Latin_Extended_Additional",
     "Latin_Extended_Additional",
     "Latin_Extended_Additional"},
    {null,                                        /* bit 30 */
     "Greek_Extended",
     "Greek_Extended",
     "Greek_Extended",
     "Greek_Extended",
     "Greek_Extended"},
    {null,                                        /* bit 31 */
     "General_Punctuation",
     "General_Punctuation",
     "General_Punctuation",
     "General_Punctuation",
     "General_Punctuation"},
    {null,                                        /* bit 32 */
     "Superscripts_And_Subscripts",
     "Superscripts_And_Subscripts",
     "Superscripts_And_Subscripts",
     "Superscripts_And_Subscripts",
     "Superscripts_And_Subscripts"},
    {null,                                        /* bit 33 */
     "Currency_Symbols",
     "Currency_Symbols",
     "Currency_Symbols",
     "Currency_Symbols",
     "Currency_Symbols"},
    {null,                                        /* bit 34 */
     "Combining_Diacritical_Marks_For_Symbols",
     "Combining_Diacritical_Marks_For_Symbols",
     "Combining_Diacritical_Marks_For_Symbols",
     "Combining_Diacritical_Marks_For_Symbols",
     "Combining_Diacritical_Marks_For_Symbols"},
    {null,                                        /* bit 35 */
     "Letterlike_Symbols",
     "Letterlike_Symbols",
     "Letterlike_Symbols",
     "Letterlike_Symbols",
     "Letterlike_Symbols"},
    {null,                                        /* bit 36 */
     "Number_Forms",
     "Number_Forms",
     "Number_Forms",
     "Number_Forms",
     "Number_Forms"},
    {null,                                        /* bit 37 */
     "Arrows",
     "Arrows",
     "Arrows",
     "Arrows",
     "Arrows"},
    {null,                                        /* bit 38 */
     "Mathematical_Operators",
     "Mathematical_Operators",
     "Mathematical_Operators",
     "Mathematical_Operators",
     "Mathematical_Operators"},
    {null,                                        /* bit 39 */
     "Miscellaneous_Technical",
     "Miscellaneous_Technical",
     "Miscellaneous_Technical",
     "Miscellaneous_Technical",
     "Miscellaneous_Technical"},
    {null,                                        /* bit 40 */
     "Control_Pictures",
     "Control_Pictures",
     "Control_Pictures",
     "Control_Pictures",
     "Control_Pictures"},
    {null,                                        /* bit 41 */
     "Optical_Character_Recognition",
     "Optical_Character_Recognition",
     "Optical_Character_Recognition",
     "Optical_Character_Recognition",
     "Optical_Character_Recognition"},
    {null,                                        /* bit 42 */
     "Enclosed_Alphanumerics",
     "Enclosed_Alphanumerics",
     "Enclosed_Alphanumerics",
     "Enclosed_Alphanumerics",
     "Enclosed_Alphanumerics"},
    {null,                                        /* bit 43 */
     "Box_Drawing",
     "Box_Drawing",
     "Box_Drawing",
     "Box_Drawing",
     "Box_Drawing"},
    {null,                                        /* bit 44 */
     "Block_Elements",
     "Block_Elements",
     "Block_Elements",
     "Block_Elements",
     "Block_Elements"},
    {null,                                        /* bit 45 */
     "Geometric_Shapes",
     "Geometric_Shapes",
     "Geometric_Shapes",
     "Geometric_Shapes",
     "Geometric_Shapes"},
    {null,                                        /* bit 46 */
     "Miscellaneous_Symbols",
     "Miscellaneous_Symbols",
     "Miscellaneous_Symbols",
     "Miscellaneous_Symbols",
     "Miscellaneous_Symbols"},
    {null,                                        /* bit 47 */
     "Dingbats",
     "Dingbats",
     "Dingbats",
     "Dingbats",
     "Dingbats"},
    {null,                                        /* bit 48 */
     "CJK_Symbols_And_Punctuation",
     "CJK_Symbols_And_Punctuation",
     "CJK_Symbols_And_Punctuation",
     "CJK_Symbols_And_Punctuation",
     "CJK_Symbols_And_Punctuation"},
    {null,                                        /* bit 49 */
     "Hiragana",
     "Hiragana",
     "Hiragana",
     "Hiragana",
     "Hiragana"},
    {null,                                        /* bit 50 */
     "Katakana",
     "Katakana",
     "Katakana",
     "Katakana",
     "Katakana"},
    {null,                                        /* bit 51 */
     "Bopomofo",
     "Bopomofo",
     "Bopomofo",
     "Bopomofo",
     "Bopomofo"},
    {null,                                        /* bit 52 */
     "Hangul_Compatibility_Jamo",
     "Hangul_Compatibility_Jamo",
     "Hangul_Compatibility_Jamo",
     "Hangul_Compatibility_Jamo",
     "Hangul_Compatibility_Jamo"},
    {null,                                        /* bit 53 */
     "CJK_Miscellaneous",
     "CJK_Miscellaneous",
     null,
     "Phags_pa",
     "Phags_pa"},
    {null,                                        /* bit 54 */
     "Enclosed_CJK_Letters_And_Months",
     "Enclosed_CJK_Letters_And_Months",
     "Enclosed_CJK_Letters_And_Months",
     "Enclosed_CJK_Letters_And_Months",
     "Enclosed_CJK_Letters_And_Months"},
    {null,                                        /* bit 55 */
     "CJK_Compatibility",
     "CJK_Compatibility",
     "CJK_Compatibility",
     "CJK_Compatibility",
     "CJK_Compatibility"},
    {null,                                        /* bit 56 */
     "Hangul",
     "Hangul",
     "Hangul",
     "Hangul",
     "Hangul"},
    {null,                                        /* bit 57 */
     null,
     "Surrogates",
     "Surrogates",
     "Surrogates",
     "Surrogates"},
    {null,                                        /* bit 58 */
     null,
     null,
     null,
     "Phoenician",
     "Phoenician" },
    {null,                                        /* bit 59 */
     "CJK_Unified_Ideographs",
     "CJK_Unified_Ideographs",
     "CJK_Unified_Ideographs",
     "CJK_Unified_Ideographs",
     "CJK_Unified_Ideographs"},
    {null,                                        /* bit 60 */
     "Private_Use_Area",
     "Private_Use_Area",
     "Private_Use_Area",
     "Private_Use_Area",
     "Private_Use_Area"},
    {null,                                        /* bit 61 */
     "CJK_Compatibility_Ideographs",
     "CJK_Compatibility_Ideographs",
     "CJK_Compatibility_Ideographs",
     "CJK_Compatibility_Ideographs",
     "CJK_Compatibility_Ideographs"},
    {null,                                        /* bit 62 */
     "Alphabetic_Presentation_Forms",
     "Alphabetic_Presentation_Forms",
     "Alphabetic_Presentation_Forms",
     "Alphabetic_Presentation_Forms",
     "Alphabetic_Presentation_Forms"},
    {null,                                        /* bit 63 */
     "Arabic_Presentation_Forms_A",
     "Arabic_Presentation_Forms_A",
     "Arabic_Presentation_Forms_A",
     "Arabic_Presentation_Forms_A",
     "Arabic_Presentation_Forms_A"},
    {null,                                        /* bit 64 */
     "Combining_Half_Marks",
     "Combining_Half_Marks",
     "Combining_Half_Marks",
     "Combining_Half_Marks",
     "Combining_Half_Marks"},
    {null,                                        /* bit 65 */
     "CJK_Compatibility_Forms",
     "CJK_Compatibility_Forms",
     "CJK_Compatibility_Forms",
     "CJK_Compatibility_Forms",
     "CJK_Compatibility_Forms"},
    {null,                                        /* bit 66 */
     "Small_Form_Variants",
     "Small_Form_Variants",
     "Small_Form_Variants",
     "Small_Form_Variants",
     "Small_Form_Variants"},
    {null,                                        /* bit 67 */
     "Arabic_Presentation_Forms_B",
     "Arabic_Presentation_Forms_B",
     "Arabic_Presentation_Forms_B",
     "Arabic_Presentation_Forms_B",
     "Arabic_Presentation_Forms_B"},
    {null,                                        /* bit 68 */
     "Halfwidth_And_Fullwidth_Forms",
     "Halfwidth_And_Fullwidth_Forms",
     "Halfwidth_And_Fullwidth_Forms",
     "Halfwidth_And_Fullwidth_Forms",
     "Halfwidth_And_Fullwidth_Forms"},
    {null,                                        /* bit 69 */
     "Specials",
     "Specials",
     "Specials",
     "Specials",
     "Specials"},
    {null,                                        /* bit 70 */
     null,
     "Tibetan",
     "Tibetan",
     "Tibetan",
     "Tibetan"},
    {null,                                        /* bit 71 */
     null,
     "Syriac",
     "Syriac",
     "Syriac",
     "Syriac"},
    {null,                                        /* bit 72 */
     null,
     "Thaana",
     "Thaana",
     "Thaana",
     "Thaana"},
    {null,                                        /* bit 73 */
     null,
     "Sinhala",
     "Sinhala",
     "Sinhala",
     "Sinhala"},
    {null,                                        /* bit 74 */
     null,
     "Myanmar",
     "Myanmar",
     "Myanmar",
     "Myanmar"},
    {null,                                        /* bit 75 */
     null,
     "Ethiopic",
     "Ethiopic",
     "Ethiopic",
     "Ethiopic"},
    {null,                                        /* bit 76 */
     null,
     "Cherokee",
     "Cherokee",
     "Cherokee",
     "Cherokee"},
    {null,                                        /* bit 77 */
     null,
     "Unified_Canadian_Syllabics",
     "Unified_Canadian_Syllabics",
     "Unified_Canadian_Syllabics",
     "Unified_Canadian_Syllabics"},
    {null,                                        /* bit 78 */
     null,
     "Ogham",
     "Ogham",
     "Ogham",
     "Ogham"},
    {null,                                        /* bit 79 */
     null,
     "Runic",
     "Runic",
     "Runic",
     "Runic"},
    {null,                                        /* bit 80 */
     null,
     "Khmer",
     "Khmer",
     "Khmer",
     "Khmer"},
    {null,                                        /* bit 81 */
     null,
     "Mongolian",
     "Mongolian",
     "Mongolian",
     "Mongolian"},
    {null,                                        /* bit 82 */
     null,
     "Braille",
     "Braille",
     "Braille",
     "Braille"},
    {null,                                        /* bit 83 */
     null,
     "Yi",
     "Yi",
     "Yi",
     "Yi"},
    {null,                                        /* bit 84 */
     null,
     null,
     "Tagalog_Hanunoo_Buhid_Tagbanwa",
     "Tagalog_Hanunoo_Buhid_Tagbanwa",
     "Tagalog_Hanunoo_Buhid_Tagbanwa"},
    {null,                                        /* bit 85 */
     null,
     null,
     "Old_Italic",
     "Old_Italic",
     "Old_Italic"},
    {null,                                        /* bit 86 */
     null,
     null,
     "Gothic",
     "Gothic",
     "Gothic"},
    {null,                                        /* bit 87 */
     null,
     null,
     "Deseret",
     "Deseret",
     "Deseret"},
    {null,                                        /* bit 88 */
     null,
     null,
     "Musical_Symbols",
     "Musical_Symbols",
     "Musical_Symbols"},
    {null,                                        /* bit 89 */
     null,
     null,
     "Mathematical_Alphanumeric_Symbols",
     "Mathematical_Alphanumeric_Symbols",
     "Mathematical_Alphanumeric_Symbols"},
    {null,                                        /* bit 90 */
     null,
     null,
     "Private_Use_Supplementary",
     "Private_Use_Supplementary",
     "Private_Use_Supplementary"},
    {null,                                        /* bit 91 */
     null,
     null,
     "Variation_Selectors",
     "Variation_Selectors",
     "Variation_Selectors"},
    {null,                                        /* bit 92 */
     null,
     null,
     "Tags",
     "Tags",
     "Tags"},
    {null,                                        /* bit 93 */
     null,
     null,
     null,
     "Limbu",
     "Limbu"},
    {null,                                        /* bit 94 */
     null,
     null,
     null,
     "Tai_Le",
     "Tai_Le"},
    {null,                                        /* bit 95 */
     null,
     null,
     null,
     "New_Tai_Lue",
     "New_Tai_Lue"},
    {null,                                        /* bit 96 */
     null,
     null,
     null,
     "Buginese",
     "Buginese"},
    {null,                                        /* bit 97 */
     null,
     null,
     null,
     "Glagolitic",
     "Glagolitic"},
    {null,                                        /* bit 98 */
     null,
     null,
     null,
     "Tifinagh",
     "Tifinagh"},
    {null,                                        /* bit 99 */
     null,
     null,
     null,
     "Yijing_Hexagram_Symbols" ,
     "Yijing_Hexagram_Symbols" },
    {null,                                        /* bit 100 */
     null,
     null,
     null,
     "Syloti_Nagri",
     "Syloti_Nagri"},
    {null,                                        /* bit 101 */
     null,
     null,
     null,
     "Linear_B",
     "Linear_B"},
    {null,                                        /* bit 102 */
     null,
     null,
     null,
     "Ancient_Greek_Numbers",
     "Ancient_Greek_Numbers"},
    {null,                                        /* bit 103 */
     null,
     null,
     null,
     "Ugaritic",
     "Ugaritic"},
    {null,                                        /* bit 104 */
     null,
     null,
     null,
     "Old_Persian",
     "Old_Persian"},
    {null,                                        /* bit 105 */
     null,
     null,
     null,
     "Shavian",
     "Shavian"},
    {null,                                        /* bit 106 */
     null,
     null,
     null,
     "Osmanya",
     "Osmanya"},
    {null,                                        /* bit 107 */
     null,
     null,
     null,
     "Cypriot_Syllabary",
     "Cypriot_Syllabary"},
    {null,                                        /* bit 108 */
     null,
     null,
     null,
     "Kharoshthi",
     "Kharoshthi"},
    {null,                                        /* bit 109 */
     null,
     null,
     null,
     "Tai_Xuan_Jing_Symbols",
     "Tai_Xuan_Jing_Symbols"},
    {null,                                        /* bit 110 */
     null,
     null,
     null,
     "Cuneiform",
     "Cuneiform"},
    {null,                                        /* bit 111 */
     null,
     null,
     null,
     "Counting_Rod_Numerals",
     "Counting_Rod_Numerals"},
    {null,                                        /* bit 112 */
     null,
     null,
     null,
     "Sundanese",
     "Sundanese"},
    {null,                                        /* bit 113 */
     null,
     null,
     null,
     "Lepcha",
     "Lepcha"},
    {null,                                        /* bit 114 */
     null,
     null,
     null,
     "Ol_Chiki",
     "Ol_Chiki"},
    {null,                                        /* bit 115 */
     null,
     null,
     null,
     "Saurashtra",
     "Saurashtra"},
    {null,                                        /* bit 116 */
     null,
     null,
     null,
     "Kayah_Li",
     "Kayah_Li"},
    {null,                                        /* bit 117 */
     null,
     null,
     null,
     "Rejang",
     "Rejang"},
    {null,                                        /* bit 118 */
     null,
     null,
     null,
     "Cham",
     "Cham"},
    {null,                                        /* bit 119 */
     null,
     null,
     null,
     "Ancient_Symbols",
     "Ancient_Symbols"},
    {null,                                        /* bit 120 */
     null,
     null,
     null,
     "Phaistos_Disc",
     "Phaistos_Disc"},
    {null,                                        /* bit 121 */
     null,
     null,
     null,
     "Carian_Lycian_Lydian",
     "Carian_Lycian_Lydian"},
    {null,                                        /* bit 122 */
     null,
     null,
     null,
     "Domino_And_Mahjong_Tiles",
     "Domino_And_Mahjong_Tiles"},
    {null,                                        /* bit 123 */
     null,
     null,
     null,
     null,
     null},
    {null,                                        /* bit 124 */
     null,
     null,
     null,
     null,
     null},
    {null,                                        /* bit 125 */
     null,
     null,
     null,
     null,
     null},
    {null,                                        /* bit 126 */
     null,
     null,
     null,
     null,
     null},
    {null,                                        /* bit 127 */
     null,
     null,
     null,
     null,
     null}};

  public static final int[] fsSelectionNames_version2format = {0, 0, 0, 0, 1, 1};
  public static final String[][] fsSelectionNames = {
    {"ITALIC",      "ITALIC"},
    {"UNDERSCORE",  "UNDERSCORE"},
    {"NEGATIVE",    "NEGATIVE"},
    {"OUTLINED",    "OUTLINED"},
    {"STRIKEOUT",   "STRIKEOUT"},
    {"BOLD",        "BOLD"},
    {"REGULAR",     "REGULAR"},
    {null,          "USE_TYPO_METRICS"},
    {null,          "WWS"},
    {null,          "OBLIQUE"}};

  public static final int[] cpNames_version2format = {-1, 0, 1, 1, 1};
  public static final String[][] cpNames = {
    {"CP_1252",     "CP_1252"},
    {"CP_1250",     "CP_1250"},
    {"CP_1251",     "CP_1251"},
    {"CP_1253",     "CP_1253"},
    {"CP_1254",     "CP_1254"},
    {"CP_1255",     "CP_1255"},
    {"CP_1256",     "CP_1256"},
    {"CP_1257",     "CP_1257"},
    {null,          "CP_1258"},
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {"CP_874",      "CP_874"},
    {"CP_932",      "CP_932"},
    {"CP_936",      "CP_936"},
    {"CP_949",      "CP_949"},
    {"CP_950",      "CP_950"},
    {"CP_1361",     "CP_1361"},
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          "Macintosh"},
    {"OEM",         "OEM"},
    {"Symbol",      "Symbol"},

    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {null,          null} ,
    {"CP_869",     "CP_869"},
    {"CP_866",     "CP_866"},
    {"CP_865",     "CP_865"},
    {"CP_864",     "CP_864"},
    {"CP_863",     "CP_863"},
    {"CP_862",     "CP_862"},
    {"CP_861",     "CP_861"},
    {"CP_860",     "CP_860"},
    {"CP_857",     "CP_857"},
    {"CP_855",     "CP_855"},
    {"CP_852",     "CP_852"},
    {"CP_775",     "CP_775"},
    {"CP_737",     "CP_737"},
    {"CP_708",     "CP_708"},
    {"CP_850",     "CP_850"},
    {"CP_437",     "CP_437"}};
</code-fragment>
      <para>The following function returns the bit position in
        ulUnicodeRange (0 through 128) that correspond to a given code
        point, or -1 if the code point is not assigned to a
        block. The set of blocks are those of Unicode 3.2.</para>
      <code-fragment id="os2.methods"><code-title>Unicode range to ulUnicodeRange map</code-title>
  private static class UnicodeRange {
    public UnicodeRange (int first, int last, int bit) {
      this.first = first;
      this.last = last;
      this.bit = bit; }
    public int first;
    public int last;
    public int bit; };


  private static UnicodeRange[] unicodeRanges = {
    new UnicodeRange (0x0000, 0x007f, 0), // Basic Latin
    new UnicodeRange (0x0080, 0x00FF, 1), // Latin-1 Supplement
    new UnicodeRange (0x0100, 0x017F, 2), // Latin Extended-A
    new UnicodeRange (0x0180, 0x024F, 3), // Latin Extended-B
    new UnicodeRange (0x0250, 0x02AF, 4), // IPA Extensions
    new UnicodeRange (0x02B0, 0x02FF, 5), // Spacing Modifier Letters
    new UnicodeRange (0x0300, 0x036F, 6), // Combining Diacritical Marks
    new UnicodeRange (0x0370, 0x03FF, 7), // Greek and Coptic
    new UnicodeRange (0x0400, 0x04FF, 9), // Cyrillic
    new UnicodeRange (0x0500, 0x052F, 9), // Cyrillic Supplementary
    new UnicodeRange (0x0530, 0x058F, 10), // Armenian
    new UnicodeRange (0x0590, 0x05FF, 11), // Hebrew
    new UnicodeRange (0x0600, 0x06FF, 13), // Arabic
    new UnicodeRange (0x0700, 0x074F, 71), // Syriac
    new UnicodeRange (0x0780, 0x07BF, 72), // Thaana
    new UnicodeRange (0x0900, 0x097F, 15), // Devanagari
    new UnicodeRange (0x0980, 0x09FF, 16), // Bengali
    new UnicodeRange (0x0A00, 0x0A7F, 17), // Gurmukhi
    new UnicodeRange (0x0A80, 0x0AFF, 18), // Gujarati
    new UnicodeRange (0x0B00, 0x0B7F, 19), // Oriya
    new UnicodeRange (0x0B80, 0x0BFF, 20), // Tamil
    new UnicodeRange (0x0C00, 0x0C7F, 21), // Telugu
    new UnicodeRange (0x0C80, 0x0CFF, 22), // Kannada
    new UnicodeRange (0x0D00, 0x0D7F, 23), // Malayalam
    new UnicodeRange (0x0D80, 0x0DFF, 73), // Sinhala
    new UnicodeRange (0x0E00, 0x0E7F, 24), // Thai
    new UnicodeRange (0x0E80, 0x0EFF, 25), // Lao
    new UnicodeRange (0x0F00, 0x0FFF, 70), // Tibetan
    new UnicodeRange (0x1000, 0x109F, 74), // Myanmar
    new UnicodeRange (0x10A0, 0x10FF, 26), // Georgian
    new UnicodeRange (0x1100, 0x11FF, 28), // Hangul Jamo
    new UnicodeRange (0x1200, 0x137F, 75), // Ethiopic
    new UnicodeRange (0x13A0, 0x13FF, 76), // Cherokee
    new UnicodeRange (0x1400, 0x167F, 77), // Unified Canadian Aboriginal Syllabics
    new UnicodeRange (0x1680, 0x169F, 78), // Ogham
    new UnicodeRange (0x16A0, 0x16FF, 79), // Runic
    new UnicodeRange (0x1700, 0x171F, -1), // Tagalog
    new UnicodeRange (0x1720, 0x173F, -1), // Hanunoo
    new UnicodeRange (0x1740, 0x175F, -1), // Buhid
    new UnicodeRange (0x1760, 0x177F, -1), // Tagbanwa
    new UnicodeRange (0x1780, 0x17FF, 80), // Khmer
    new UnicodeRange (0x1800, 0x18AF, 81), // Mongolian
    new UnicodeRange (0x1E00, 0x1EFF, 29), // Latin Extended Additional
    new UnicodeRange (0x1F00, 0x1FFF, 30), // Greek Extended
    new UnicodeRange (0x2000, 0x206F, 31), // General Punctuation
    new UnicodeRange (0x2070, 0x209F, 32), // Superscripts and Subscripts
    new UnicodeRange (0x20A0, 0x20CF, 33), // Currency Symbols
    new UnicodeRange (0x20D0, 0x20FF, 34), // Combining Diacritical Marks for Symbols
    new UnicodeRange (0x2100, 0x214F, 35), // Letterlike Symbols
    new UnicodeRange (0x2150, 0x218F, 36), // Number Forms
    new UnicodeRange (0x2190, 0x21FF, 37), // Arrows
    new UnicodeRange (0x2200, 0x22FF, 38), // Mathematical Operators
    new UnicodeRange (0x2300, 0x23FF, 39), // Miscellaneous Technical
    new UnicodeRange (0x2400, 0x243F, 40), // Control Pictures
    new UnicodeRange (0x2440, 0x245F, 41), // Optical Character Recognition
    new UnicodeRange (0x2460, 0x24FF, 42), // Enclosed Alphanumerics
    new UnicodeRange (0x2500, 0x257F, 43), // Box Drawing
    new UnicodeRange (0x2580, 0x259F, 44), // Block Elements
    new UnicodeRange (0x25A0, 0x25FF, 45), // Geometric Shapes
    new UnicodeRange (0x2600, 0x26FF, 46), // Miscellaneous Symbols
    new UnicodeRange (0x2700, 0x27BF, 47), // Dingbats
    new UnicodeRange (0x27C0, 0x27EF, -1), // Miscellaneous Mathematical Symbols-A
    new UnicodeRange (0x27F0, 0x27FF, -1), // Supplemental Arrows-A
    new UnicodeRange (0x2800, 0x28FF, 82), // Braille Patterns
    new UnicodeRange (0x2900, 0x297F, -1), // Supplemental Arrows-B
    new UnicodeRange (0x2980, 0x29FF, -1), // Miscellaneous Mathematical Symbols-B
    new UnicodeRange (0x2A00, 0x2AFF, -1), // Supplemental Mathematical Operators
    new UnicodeRange (0x2E80, 0x2EFF, 59), // CJK Radicals Supplement
    new UnicodeRange (0x2F00, 0x2FDF, 59), // Kangxi Radicals
    new UnicodeRange (0x2FF0, 0x2FFF, 59), // Ideographic Description Characters
    new UnicodeRange (0x3000, 0x303F, 48), // CJK Symbols and Punctuation
    new UnicodeRange (0x3040, 0x309F, 49), // Hiragana
    new UnicodeRange (0x30A0, 0x30FF, 50), // Katakana
    new UnicodeRange (0x3100, 0x312F, 51), // Bopomofo
    new UnicodeRange (0x3130, 0x318F, 52), // Hangul Compatibility Jamo
    new UnicodeRange (0x3190, 0x319F, -1), // Kanbun
    new UnicodeRange (0x31A0, 0x31BF, 51), // Bopomofo Extended
    new UnicodeRange (0x31F0, 0x31FF, -1), // Katakana Phonetic Extensions
    new UnicodeRange (0x3200, 0x32FF, 54), // Enclosed CJK Letters and Months
    new UnicodeRange (0x3300, 0x33FF, 55), // CJK Compatibility
    new UnicodeRange (0x3400, 0x4DBF, 59), // CJK Unified Ideographs Extension A
    new UnicodeRange (0x4E00, 0x9FFF, 59), // CJK Unified Ideographs
    new UnicodeRange (0xA000, 0xA48F, 83), // Yi Syllables
    new UnicodeRange (0xA490, 0xA4CF, 83), // Yi Radicals
    new UnicodeRange (0xAC00, 0xD7AF, 56), // Hangul Syllables
    new UnicodeRange (0xD800, 0xDB7F, 57), // High Surrogates
    new UnicodeRange (0xDB80, 0xDBFF, 57), // High Private Use Surrogates
    new UnicodeRange (0xDC00, 0xDFFF, 57), // Low Surrogates
    new UnicodeRange (0xE000, 0xF8FF, 60), // Private Use Area
    new UnicodeRange (0xF900, 0xFAFF, 61), // CJK Compatibility Ideographs
    new UnicodeRange (0xFB00, 0xFB4F, 62), // Alphabetic Presentation Forms
    new UnicodeRange (0xFB50, 0xFDFF, 63), // Arabic Presentation Forms-A
    new UnicodeRange (0xFE00, 0xFE0F, -1), // Variation Selectors
    new UnicodeRange (0xFE20, 0xFE2F, 64), // Combining Half Marks
    new UnicodeRange (0xFE30, 0xFE4F, 65), // CJK Compatibility Forms
    new UnicodeRange (0xFE50, 0xFE6F, 66), // Small Form Variants
    new UnicodeRange (0xFE70, 0xFEFF, 67), // Arabic Presentation Forms-B
    new UnicodeRange (0xFF00, 0xFFEF, 68), // Halfwidth and Fullwidth Forms
    new UnicodeRange (0xFFF0, 0xFFFF, 69), // Specials
    new UnicodeRange (0x10300, 0x1032F, -1), // Old Italic
    new UnicodeRange (0x10330, 0x1034F, -1), // Gothic
    new UnicodeRange (0x10400, 0x1044F, -1), // Deseret
    new UnicodeRange (0x1D000, 0x1D0FF, -1), // Byzantine Musical Symbols
    new UnicodeRange (0x1D100, 0x1D1FF, -1), // Musical Symbols
    new UnicodeRange (0x1D400, 0x1D7FF, -1), // Mathematical Alphanumeric Symbols
    new UnicodeRange (0x20000, 0x2A6DF, -1), // CJK Unified Ideographs Extension B
    new UnicodeRange (0x2F800, 0x2FA1F, -1), // CJK Compatibility Ideographs Supplement
    new UnicodeRange (0xE0000, 0xE007F, -1), // Tags
    new UnicodeRange (0xF0000, 0xFFFFF, -1), //  Supplementary Private Use Area-A
    new UnicodeRange (0x100000, 0x10FFFF, -1), // Supplementary Private Use Area-B
  };

  public static int bitForCodePoint (int cp) {
    int min = 0;
    int max = unicodeRanges.length - 1;

    // invariant: if cp is covered by one of the ranges, then the
    // index of that range is between min and max (both included)

    while (min &lt;= max) {
      int s = (min + max) / 2;
      if (cp &lt; unicodeRanges [s].first) {
        max = s - 1; }
      else if (unicodeRanges [s].last &lt; cp) {
        min = s + 1; }
      else {
        if (   unicodeRanges [s].first &lt;= cp
            &amp;&amp; cp &lt;= unicodeRanges [s].last) {
          return unicodeRanges [s].bit; }
        else {
          return -1; }}}

    return -1;
  }
</code-fragment>
      <code-fragment id="os2.methods"><code-title>Test ulUnicodeRange support</code-title>
  public boolean unicodeRangeSupported (int i) {
    int offset = 42 + 4 * (i / 32);
    long range = getuint32 (offset);
    return (range &amp; (1 &lt;&lt; (i % 32))) != 0;
  }

  public boolean codePageSupported (int i) {
    if (data.length &lt; 86) {
      return false; }
    int offset = 78 + 4 * (i / 32);
    long range = getuint32 (offset);
    return (range &amp; (1 &lt;&lt; (i % 32))) != 0;
  }
</code-fragment>
      <para>Warning: this interpertation of fsType is not necessarily
    correct.</para>
      <code-fragment id="os2.methods"><code-title>fsType</code-title>
  public int getFsType () {
    return getuint16 (8);
  }

  public boolean allowsSubsettingOutlineEmbedding () {
    int fsType = getFsType ();

    if (fsType == 0) {
      return true; }

    if (   ((fsType &amp; 0x0004) != 0 || (fsType &amp; 0x0008) != 0)
        &amp;&amp; (fsType &amp; 0x0100) == 0
        &amp;&amp; (fsType &amp; 0x0200) == 0) {
      return true; }

    return false;
  }
</code-fragment>
    </section>
  
