<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<section role="compiler">
      <title>Compiler</title>
      <code-fragment id="hdmx.methods">
  public void fromXML (Element hdmx)
    throws InvalidFontException, UnsupportedFontException {

    NodeList deviceRecords = hdmx.getChildNodes ();

    int numRecords = deviceRecords.getLength ();

    int sizeDeviceRecord = 0;

    for (int i = 0; i &lt; numRecords; i++) {
      Element deviceRecord = (Element) deviceRecords.item (i);
      int deviceRecordSize = 2 + deviceRecord.getChildNodes ().getLength ();
      sizeDeviceRecord = Math.max (deviceRecordSize, sizeDeviceRecord); }

    while (sizeDeviceRecord % 4 != 0) {
      sizeDeviceRecord++; }

    Block me = new Block (2 + 2 + 4 + numRecords * sizeDeviceRecord, 0);

    int offset = 0;

    me.setuint16 (offset,
                  Integer.decode (hdmx.getAttribute ("version")).intValue ());
    me.setint16 (offset + 2, numRecords);
    me.setint32 (offset + 4, sizeDeviceRecord);

    offset += 8;

    for (int i = 0; i &lt; numRecords; i++) {
      Element deviceRecord = (Element) deviceRecords.item (i);
      me.setuint8 (offset, Integer.decode (deviceRecord.getAttribute ("pixelSize")).intValue ());
      offset++;
      me.setuint8 (offset, Integer.decode (deviceRecord.getAttribute ("maxWidth")).intValue ());
      offset++;

      NodeList widths = deviceRecord.getChildNodes ();
      for (int j = 0; j &lt; widths.getLength (); j++) {
        Element width = (Element) widths.item (j);
        me.setuint8 (offset, Integer.decode (width.getAttribute ("v")).intValue ());
        offset ++; }

      while (offset % 4 != 0) {
       offset++; }}

    data = me.serialize ();
  }
</code-fragment>
    </section>
    
